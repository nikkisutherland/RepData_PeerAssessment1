---
title: "Reproducible Research: Peer Assessment 1"
author: "Nikki Sutherland"
date: "January 17, 2015"
output: html_document
keep_md: true
---

## Introduction

This assignment takes activity data from a personal activity monitoring device 
and performs some basic analysis on the steps taken per 5-minute interval for 
a 2-month period.

The variables included in this dataset are:

* **steps**: Number of steps taking in a 5-minute interval (missing values are
    coded as `NA`)

* **date**: The date on which the measurement was taken in YYYY-MM-DD format

* **interval**: Identifier for the 5-minute interval in which
    measurement was taken
    
The interval is essentially the given time of day. For example, 955 is 9:55 AM
and 1810 corresponds to 6:10 PM.

### Loading and Preprocessing the Data
  
Load the packages to be used for analysis:

```{r warning=FALSE, message=FALSE, echo=TRUE}
library(plyr)
library(knitr)
```

  
Create a "data" directory and then load the data:

```{r echo=TRUE}
if (!file.exists("./data")) { dir.create("./data") }
activity_file <- "activity.zip"
unzip(activity_file, overwrite = TRUE, list = FALSE, junkpaths = TRUE, 
      exdir = "./data", unzip = "internal", setTimes = FALSE)
activity_data <- read.csv("./data/activity.csv", colClasses = c("numeric", "character", "numeric"))
```


The activity data looks like this:

```{r echo=TRUE}
head(activity_data)
tail(activity_data)
summary(activity_data)
```


Remove the rows with NA values:

```{r echo=TRUE}
complete_data <- activity_data[complete.cases(activity_data),]
```


### Mean Total Number of Steps Taken per Day

Use ddply to get the total steps for each day:
```{r echo=TRUE}
total_steps <- ddply(complete_data, .(date), summarize, Total_steps=sum(steps))
head(total_steps)
tail(total_steps)
summary(total_steps)
```

Create a histogram of the total number of steps taken each day:

```{r total_daily_steps, echo=TRUE}
hist(total_steps$Total_steps, main = "Total Steps Taken per Day", xlab = "Total Steps")
```

Then take the mean and median total number of steps taken per day:
```{r echo=TRUE, eval=TRUE}
mean(total_steps$Total_steps)
median(total_steps$Total_steps)
```



### Average Daily Activity Pattern?

Use ddply to calculate the average number of steps taken at each interval:
```{r echo=TRUE}
average_steps_interval <- ddply(complete_data, .(interval), summarize, Average_steps=mean(steps))
```

Create a time series plot of the 5-minute interval and the average number of steps taken, averaged across all days:
```{r average_interval_steps, echo=TRUE}
plot(average_steps_interval$interval, average_steps_interval$Average_steps, 
     type = "l", main = "Average Steps Taken per 5-minute Interval",
     xlab = "Interval", ylab = "Average Steps Taken")
```

Determine which 5-minute interval, on average across all the days in the dataset,contains the maximum number of steps:
```{r echo=TRUE}
max_steps <- which.max(as.double(average_steps_interval$Average_steps))
average_steps_interval[max_steps, "interval"]
```

### Inputing Missing Values



Calculate and report the total number of missing values in the dataset:



Create a new dataset that is equal to the original dataset but with the
missing data filled in:


### Comparing Weekday and Weekend Activity Patterns





